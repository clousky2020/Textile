<% if current_user %>
  <nav class="navbar navbar-expand-md bg-light navbar-light" role="navigation">
    <%= link_to "主页", root_url, class: "navbar-brand mr-auto" %>
    <!-- Toggler/collapsibe Button -->
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="collapsibleNavbar">
      <ul class="navbar-nav">

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown">
            人事管理
          </a>
          <div class="dropdown-menu">
            <% if can? :read, Employee %>
              <%= link_to "员工管理", employee_index_path, class: "dropdown-item" %>
            <% end %>
            <% if can? :create, User %>
              <%= link_to "用户管理", users_path, class: "dropdown-item" %>
            <% end %>

          </div>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown">
            生产资料
          </a>
          <div class="dropdown-menu">
            <% if can? :read, Repo %>
              <%= link_to "仓库管理", repos_path, class: "dropdown-item" %>
            <% end %>
            <% if can? :read, ChangeMachine %>
              <%= link_to "改机情况记录", change_machines_path, class: "dropdown-item" %>
            <% end %>
            <% if can? :read, Material %>
              <%= link_to "原料管理", materials_path, class: "dropdown-item " %>
            <% end %>
            <% if can? :read, Product %>
              <%= link_to "产品管理", products_path, class: "dropdown-item " %>
            <% end %>
          </div>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown">
            收付款管理
          </a>
          <div class="dropdown-menu">
            <% if can? :read, Proceed %>
              <%= link_to "收款单", proceeds_path, class: "dropdown-item" %>
            <% end %>
            <% if can? :read, Expense %>
              <%= link_to "付款单", expenses_path, class: "dropdown-item" %>
            <% end %>
          </div>
        </li>

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown">
            订单管理
          </a>
          <div class="dropdown-menu">
            <% if can? :read, PurchaseOrder %>
              <%= link_to "采购单", purchase_orders_path, class: "dropdown-item" %>
            <% end %>
            <% if can? :read, PurchaseSupplier %>
              <%= link_to "供应商", purchase_suppliers_path, class: "dropdown-item" %>
            <% end %>
            <div class="dropdown-divider"></div>
            <% if can? :read, SaleOrder %>
              <%= link_to "销售单", sale_orders_path, class: "dropdown-item" %>
            <% end %>
            <% if can? :read, SaleCustomer %>
              <%= link_to "客户", sale_customers_path, class: "dropdown-item" %>
            <% end %>
          </div>
        </li>
        <% if can? :update, Setting %>
          <li class="nav-link">
            <%= link_to "参数设定", settings_path %>
          </li>
        <% end %>
        <li class="nav-link dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" id="current_user_name">
            <%= current_user.name %>
            <span class="caret"></span>
          </a>
          <input type="hidden" id="current_user_id" value="<%= current_user.id %>"/>
          <ul class="dropdown-menu">
            <%= link_to "个人信息", user_path(current_user), class: "dropdown-item" %>
            <%= link_to "更改密码", edit_password_reset_path(current_user), class: "dropdown-item " %>
            <%= link_to "退出", session_path(current_user), method: :delete, class: "dropdown-item " %>
          </ul>
        </li>

      </ul>
    </div>

  </nav>
<% end %>


